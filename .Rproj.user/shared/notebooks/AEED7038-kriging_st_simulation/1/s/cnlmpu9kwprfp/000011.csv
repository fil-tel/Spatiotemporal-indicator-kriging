"0","oldesttime <- -Inf"
"0","youngesttime <- 0"
"0","# This way years are second and I subtratc them to the origin"
"0","# Origin is at 190 1 1 and 1 minute"
"0","dataTM <- as.POSIXlt(-my.df$TIME, origin=""1970-01-01"")"
"0","oldestdata <- max( oldesttime, min(-my.df$TIME) )"
"0","# This correspod to the oldest in POISXlt time"
"0","oldestdataTM <- as.POSIXlt(oldestdata, origin=""1970-01-01"")"
"0","youngestdata <- min( youngesttime, max(-my.df$TIME) )"
"0","youngestdataTM <- as.POSIXlt(youngestdata, origin=""1970-01-01"")"
"0","# Create 5 timepoints, every 20 years"
"0","numtimepoints=5"
"0","# Create temporal grid"
"0","if(!is.na(numtimepoints)){"
"0","	rawtimegrid <- round(seq(oldestdata,youngestdata,length.out=numtimepoints))"
"0","	tm.grid <- seq(as.POSIXct(oldestdataTM),as.POSIXct(youngestdataTM),length.out=numtimepoints)"
"0","} else {"
"0","       rawtimegrid <- sort(unique(-data.UTM$TIME))"
"0","       tm.grid <- as.POSIXct(rawtimegrid, origin=""1970-01-01"")"
"0","}"
"0",""
"0","# Create spatiotemporal grid"
"0","# basically add a third dimension that it is time"
"0","grid.ST <- STF(grid, tm.grid)"
