"0","m10<-vgm(0.15,""Exp"",40000,0.05)"
"0","# least square fit"
"0","anistart <- 1"
"0","aniend <- 500"
"0","anistep <- 10"
"0","pars.l <- c(sill.s = 0, range.s = 0, nugget.s = 0,sill.t = 0, range.t = 0, nugget.t = 0,sill.st = 0, range.st = 0, nugget.st = 0, anis = 0)"
"0","#pars.u <- c(sill.s = 1e7, range.s = 1e7, nugget.s = 1e7,sill.t = 1e7, range.t = 1e7, nugget.t = 1e7,sill.st = 1e7, range.st = 1e7, nugget.st = 1e7,anis = 1e7)"
"0","finalVgmMSE <- Inf"
"0","finalVgm <- NULL"
"0","for( anisotropy in seq(anistart,aniend,anistep)){"
"0","    try( {"
"0","    metric <- vgmST(""metric"", joint = m10, stAni=anisotropy)"
"0","    # prodSumModel <- vgmST(""productSum"",space = vgm(1, ""Exp"", 150, 0.5),time = vgm(1, ""Exp"", 5, 0.5),k = 50) "
"0","    metric_Vgm <- fit.StVariogram(var, metric, method=""L-BFGS-B"", tunit=""secs"")"
"0","    mse <- attr(metric_Vgm,""MSE"")"
"0","    #print(paste(""Anisotropy: "",anisotropy,""; MSE: "",mse,sep=""""))"
"0","    if(mse < finalVgmMSE){"
"0","        finalVgmMSE <- mse"
"0","        finalVgm <- metric_Vgm"
"0","    }"
"0","    }, silent = TRUE)"
"0","}"
